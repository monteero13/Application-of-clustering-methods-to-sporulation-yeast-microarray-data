---
title: "HC_DENDROGRAM SOLUTIONS"
author: "Alberto Montero Solera"
date: "`r format(Sys.time(), '%A %d, %B %Y. %X')`"
output:
  html_document:
    fig_caption: yes
    number_sections: yes
    toc: yes
    toc_float: yes
    toc_depth: 2
    theme: readable # cosmo, flatly, journal, lumen, paper, readable, sandstone, simplex, spacelab, yeti
    code_folding: "show"
  pdf_document:
    toc: yes
    fig_caption: yes
    df_print: kable
---
```{r setup, include=FALSE}
knitr::opts_chunk$set(echo = TRUE)
```

# Initial description

Given the following distance matrix, draw the dendogram for HIERARCHICAL AGGLOMERATIVE CLUSTERING in the following cases:

![**Figura 1**:Initial Distance Matrix](C:/Users/13alb/Documents/Aprendizaje Computacional/si.png)

# Cases {.tabset .tabset-fade .tabset-pills}

To verify the results obtained manually I'm going to use the next libraries:

-   **dendextend**
-   **factoextra**

```{r, message=FALSE}
if(!require("dendextend", quietly = TRUE)){
  install.packages("dendextend", dependencies = TRUE)
  library(dendextend)
}

if(!require("factoextra", quietly = TRUE)){
  install.packages("factoextra", dependencies = TRUE)
  library("factoextra")
}

if(!require("knitr", quietly = TRUE)){
  install.packages("knitr", dependencies = TRUE)
  library("knitr")
}
```


## Single Link Agglomerative Clustering

In Single Link, in each iteration, the pair of clusters with the minimum distance is selected.

### Iteration 1

The minimum distance is 0.21 between *C* and *E* so we cluster them.

|| A | B | CE | D | F | G |
|:---|:---:|:---:|:---:|:---:|---:|
| A | 0 | 2.15 | 0.7 | 1.07 | 1.16 | 1.56 |
| B | 2.15 | 0 | 1.38 | 1.14 | 1.01 | 2.83 |
| CE | 0.7 | 1.38 | 0 | 0.43 | 0.22 | 1.86 |
| D | 1.07 | 1.14 | 0.43 | 0 | 0.22 | 2.04 |
| F | 1.16 | 1.01 | 0.22 | 0.22 | 0 | 2.02 |
| G | 1.56 | 2.83 | 1.86 | 2.04 | 2.02 | 0 |


### Iteration 2

The new minimum distance is 0.22 between *CE* and *F*.
Then we group *CE* and *F* in the cluster *CEF*.

|| A | B | CEF | D | G |
|:---|:---:|:---:|:---:|---:|
| A | 0 | 2.15 | 0.7 | 1.07  | 1.56 |
| B | 2.15 | 0 | 1.01 | 1.14 | 2.83 |
| CEF | 0.7 | 1.01 | 0 | 0.22 | 1.86 |
| D | 1.07 | 1.14 | 0.22 | 0 | 2.04 |
| G | 1.56 | 2.83 | 1.86 | 2.04 | 0 |

### Iteration 3

The minimum distance is 0.22 between *CEF* and *D* so we group them.

|| A | B | CEFD | G |
|:---|:---:|:---:|---:|
| A | 0 | 2.15 | 0.7 | 1.56 |
| B | 2.15 | 0 | 1.01 | 2.83 |
| CEFD | 0.7 | 1.01 | 0 | 1.86 |
| G | 1.56 | 2.83 | 1.86 | 0 |

### Iteration 4

The minimum distance is 0.7 and is between *A* and *CEFD*.

|| B | ACEFD | G |
|:---|:---:|---:|
| B | 0 | 1.01 | 2.83 |
| ACEFD | 1.01 | 0 | 1.86 |
| G | 2.83 | 1.86 | 0 |

### Iteration 5

The minimum distance is 1.01 between *B* and *ACEFD*.

||BACEFD | G |
|:---|---:|
| BACEFD | 0 | 1.86 |
| G | 1.86 | 0 |

### Final result

The final result would be obtained by grouping *G* with *BACEFD*.

```{r}
distancias <- matrix(c(
  0, 2.15, 0.7, 1.07, 0.85, 1.16, 1.56,
  2.15, 0, 1.53, 1.14, 1.38, 1.01, 2.83,
  0.7, 1.53, 0, 0.43, 0.21, 0.55, 1.86,
  1.07, 1.14, 0.43, 0, 0.29, 0.22, 2.04,
  0.85, 1.38, 0.21, 0.29, 0, 0.41, 2.02,
  1.16, 1.01, 0.55, 0.22, 0.41, 0, 2.05,
  1.56, 2.83, 1.86, 2.04, 2.02, 2.05, 0
), nrow=7, byrow=TRUE)

rownames(distancias) <- colnames(distancias) <- c("A", "B", "C", "D", "E", "F", "G")

hc_single <- hclust(as.dist(distancias), method = "single")
dend_single <- as.dendrogram(hc_single)

par(mfrow = c(1, 2))  

plot(dend_single, main = "Dendrograma - Single Linkage")
```


## Complete Link Agglomerative Clustering

In Complete Link, the pair of clusters with the maximum minimum distance is selected in each iteration.

### Iteration 1

The minimum distance is 0.21 between *c* and *E*.

|| A | B | CE | D | F | G |
|:---|:---:|:---:|:---:|:---:|---:|
| A | 0 | 2.15 | 0.85 | 1.07 | 1.16 | 1.56 |
| B | 2.15 | 0 | 1.53 | 1.14 | 1.01 | 2.83 |
| CE | 0.85 | 1.53 | 0 | 0.43 | 0.55 | 2.02 |
| D | 1.07 | 1.14 | 0.43 | 0 | 0.22 | 2.04 |
| F | 1.16 | 1.01 | 0.55 | 0.22 | 0 | 2.05 |
| G | 1.56 | 2.83 | 2.02 | 2.04 | 2.05 | 0 |

### Iteration 2

The new minimum distance is 0.22 between *D* and *F*.
Then we group *D* and *F* in the cluster *DF*.

|| A | B | CE | DF | G |
|:---|:---:|:---:|:---:|---:|
| A | 0 | 2.15 | 0.85 | 1.16 | 1.56 |
| B | 2.15 | 0 | 1.53 | 1.14 | 2.83 |
| CE | 0.85 | 1.53 | 0 | 0.55 | 2.02 |
| DF | 1.16 | 1.14 | 0.55 | 0 | 2.04 |
| G | 1.56 | 2.83 | 2.02 | 2.04 | 0 |

### Iteration 3

The minimum distance is 0.55 between *CE* and *DF* so we group them.

|| A | B | CEDF | G |
|:---|:---:|:---:|---:|
| A | 0 | 2.15 | 1.16 | 1.56 |
| B | 2.15 | 0 | 1.53 | 2.83 |
| CEDF | 1.16 | 1.53 | 0 | 2.04 |
| G | 1.56 | 2.83 | 2.04 | 0 |

### Iteration 4

The minimum distance is 1.16 and is between *A* and *CEDF*.

|| B | ACEDF | G |
|:---|:---:|---:|
| B | 0 | 2.15 | 2.04 |
| ACEDF | 2.15 | 0 | 2.83 |
| G | 2.04 | 2.83 | 0 |

### Iteration 5

The minimum distance is 2.04 between *ACEDFG* and *B*.

||ACEFDG | B |
|:---|---:|
| ACEFDG | 0 | 2.83 |
| B | 2.83 | 0 |


### Final result 

The final result would be obtained by grouping *B* with *ACEFDG*.

```{r}
distancias <- matrix(c(
  0, 2.15, 0.7, 1.07, 0.85, 1.16, 1.56,
  2.15, 0, 1.53, 1.14, 1.38, 1.01, 2.83,
  0.7, 1.53, 0, 0.43, 0.21, 0.55, 1.86,
  1.07, 1.14, 0.43, 0, 0.29, 0.22, 2.04,
  0.85, 1.38, 0.21, 0.29, 0, 0.41, 2.02,
  1.16, 1.01, 0.55, 0.22, 0.41, 0, 2.05,
  1.56, 2.83, 1.86, 2.04, 2.02, 2.05, 0
), nrow=7, byrow=TRUE)

rownames(distancias) <- colnames(distancias) <- c("A", "B", "C", "D", "E", "F", "G")

hc_complete <- hclust(as.dist(distancias), method = "complete")

dend_complete <- as.dendrogram(hc_complete)

par(mfrow = c(1, 2))  

plot(dend_complete, main = "Dendrograma - Complete Linkage")
```

## Group Average Agglomerative Clustering

In Group Average,  the distance between clusters is the average of all distances between the points.

### Iteration 1

The minimum distance is 0.21 between *C* and *E*.

|| A | B | CE | D | F | G |
|:---|:---:|:---:|:---:|:---:|---:|
| A | 0 | 2.15 | 0.775 | 1.07 | 1.16 | 1.56 |
| B | 2.15 | 0 | 1.455 | 1.14 | 1.01 | 2.83 |
| CE | 0.775 | 1.455 | 0 | 0.36 | 0.48 | 1.955 |
| D | 1.07 | 1.14 | 0.36 | 0 | 0.22 | 2.04 |
| F | 1.16 | 1.01 | 0.48 | 0.22 | 0 | 2.05 |
| G | 1.56 | 2.83 | 1.955 | 2.04 | 2.05 | 0 |

### Iteration 2

The new minimum distance is 0.22 between *D* and *F*.
Then we group *D* and *F* in the cluster *DF*.

|| A | B | CE | DF | G |
|:---|:---:|:---:|:---:|---:|
| A | 0 | 2.15 | 0.775 | 1.115 | 1.56 |
| B | 2.15 | 0 | 1.455 | 1.075 | 2.83 |
| CE | 0.775 | 1.455 | 0 | 0.42 | 1.955 |
| DF | 1.115 | 1.075 | 0.42 | 0 | 2.045 |
| G | 1.56 | 2.83 | 1.955 | 2.045 | 0 |

### Iteration 3

The minimum distance is 0.42 between *CE* and *DF* so we group them.

|| A | B | CEDF | G |
|:---|:---:|:---:|---:|
| A | 0 | 2.15 | 0.945 | 1.56 |
| B | 2.15 | 0 | 1.265 | 2.83 |
| CEDF | 0.945 | 1.265 | 0 | 2 |
| G | 1.56 | 2.83 | 2 | 0 |

### Iteration 4

The minimum distance is 0.945 and is between *A* and *CEDF*.

|| B | ACEDF | G |
|:---|:---:|---:|
| B | 0 | 1.7075 | 2.83 |
| ACEDF | 1.7075 | 0 | 1.78 |
| G | 2.83 | 1.78 | 0 |

### Iteration 5

The minimum distance is 1.7075 between *ACEDF* and *B*.

||ABCEFD | G |
|:---|---:|
| ABCEFD | 0 | 2.305 |
| G | 2.305 | 0 |


### Final result 

The final result would be obtained by grouping *G* with *ABCEFD*.

```{r}
distancias <- matrix(c(
  0, 2.15, 0.7, 1.07, 0.85, 1.16, 1.56,
  2.15, 0, 1.53, 1.14, 1.38, 1.01, 2.83,
  0.7, 1.53, 0, 0.43, 0.21, 0.55, 1.86,
  1.07, 1.14, 0.43, 0, 0.29, 0.22, 2.04,
  0.85, 1.38, 0.21, 0.29, 0, 0.41, 2.02,
  1.16, 1.01, 0.55, 0.22, 0.41, 0, 2.05,
  1.56, 2.83, 1.86, 2.04, 2.02, 2.05, 0
), nrow=7, byrow=TRUE)

rownames(distancias) <- colnames(distancias) <- c("A", "B", "C", "D", "E", "F", "G")

hc_average <- hclust(as.dist(distancias), method = "average")

dend_average <- as.dendrogram(hc_average)

par(mfrow = c(1, 2))  

plot(dend_average, main = "Dendrograma - Group Average Linkage")
```